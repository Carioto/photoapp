<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Family Photos{% endblock %}</title>

  <style>
  :root {--bg: #d9e5f2; --card: #ffffff; --border: #e1e5ea; --text: #1f2933; --muted: #6b7280;
    --accent: #3b82f6; --accent-soft: #e0ecff;}
  :root[data-theme="dark"] {--bg: #0f1115; --card: #171a21; --border: #2a2f3a; --text: #e7e9ee;
    --muted: #a7adba; --accent: #d8b37c; --accent-soft: #2a2f3a;}
  body {background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;}
  a { color: inherit; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .muted { color: var(--muted); font-size: 14px; }
  .btn {padding: 8px 10px; border-radius: 10px; cursor: pointer; background: var(--accent-soft); border: 1px solid var(--border); color: var(--text); line-height: 1;}
  .topbar {display: flex; justify-content: space-between; align-items: center; padding: 10px 14px; background: var(--card);
    border-bottom: 1px solid var(--border); gap: 10px;}
  .topbar-left, .topbar-right { display: flex; align-items: center; gap: 10px; }
  .brand { font-weight: 700; }
  .page {max-width: 1100px; margin: 0 auto; padding: 16px 8px;}
  body.drawer-lock {position: fixed; width: 100%; overflow: hidden;}
  .drawer-backdrop {position: fixed; inset: 0; background: rgba(0,0,0,.35); display: none; z-index: 50;}
  .drawer-backdrop.open { display: block; }
  .drawer {position: fixed; top: 0; left: 0; height: 100vh; width: min(92vw, 380px); background: var(--card);
    border-right: 1px solid var(--border); transform: translateX(-100%); transition: transform .18s ease;
    z-index: 60; display: flex; flex-direction: column; overflow: hidden;}
  .drawer.open { transform: translateX(0); }
  .drawer-header {padding: 12px 14px; border-bottom: 1px solid var(--border); display: flex;
    justify-content: space-between; align-items: center;}
  .drawer-body{flex: 1; min-height: 0; padding: 12px 14px; display: block; overflow-y: auto;
  -webkit-overflow-scrolling: touch;}
  .card {border-radius: 14px; overflow: hidden; background: var(--card); border: 1px solid var(--border);
    box-shadow: 0 1px 6px rgba(0,0,0,.05); }
  .pad { padding: 10px 12px; }
  form { margin: 0; }
  .grid {display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;}
@media (min-width: 640px) {.grid { grid-template-columns: repeat(3, 1fr); }}
@media (min-width: 900px) {.grid { grid-template-columns: repeat(4, 1fr); }}
.thumb {width: 100%;height: 160px;object-fit: cover;display: block;background: #f3f3f3;}
@media (min-width: 640px) {.thumb { height: 190px; }}
textarea {width: 100%; min-height: 140px; padding: 12px; border-radius: 12px; border: 1px solid var(--border);
  background: var(--card); color: var(--text); font-family: inherit; font-size: 15px; line-height: 1.4;
  resize: vertical;}
.photo-stage {width: 100%; max-height: 70vh; overflow: auto; border-radius: 14px; border: 1px solid var(--border);
  background: var(--card); -webkit-overflow-scrolling: touch;}
.stage-img {display: block; max-width: none; width: 100%; height: auto;}
/* Menu drawer: make nav links behave on small screens */
a {display: block; margin-bottom: 5px;}
.pagination{display: flex; align-items: center; justify-content: center; gap: 12px; margin: 20px 0; flex-wrap: wrap;}
.pagination .btn{min-width: 80px; text-align: center;}
.pagination-info{white-space: nowrap;}
.thumb-wrap{position: relative;}
.fav-badge{position: absolute; top: 5px; right: 5px; transform: translate(-50%, -50%); width: 10px; height: 10px;
  border-radius: 999px; display: grid; place-items: center; font-weight: 900; font-size: 18px;
  color: #d8b37c; /* gold */ border: 1px solid rgba(0,0,0,.12);
  box-shadow: 0 2px 10px rgba(0,0,0,.25); pointer-events: none;}
</style>

  </head>

  <body>
    <header class="topbar">
      <div class="topbar-left">
        <button id="mobileMenuBtn" class="btn" type="button" aria-label="Menu">‚ò∞</button>
        <a class="brand" href="/">Home</a>
      </div>

      <div class="topbar-right">
        <button id="themeToggle" class="btn" type="button">üåô</button>
        <span class="muted">{{ user.username }}</span>
        <form method="post" action="/accounts/logout/">
          {% csrf_token %}
          <button class="btn" type="submit">Logout</button>
        </form>
      </div>
    </header>

    <!-- Mobile menu drawer -->
    <div id="mobileMenuBackdrop" class="drawer-backdrop"></div>

    <nav id="mobileMenu" class="drawer">
      <div class="drawer-header">
        <div style="font-weight:700;">Menu</div>
        <button id="closeMobileMenu" class="btn" type="button">Close</button>
      </div>
      <div class="nav">
        <a class="btn" href="/">Home</a>
        <a class="btn" href="/albums/">View by Date Added</a>
        <a class="btn" href="/photos/">View by Tags</a>
        <a class="btn" href="{% url 'favorites' %}">Favorites</a>
        <a class="btn" href="{% url 'recent_comments' %}">Recent Comments</a>
      </div>
    </nav>

    <div class="shell">
  

      <!-- Main content -->
      <main>
        {% block content %}{% endblock %}
      </main>
    </div>

    <!-- Dark mode toggle -->
    <script>
      (function () {
        const root = document.documentElement;
        const btn = document.getElementById("themeToggle");
        if (!btn) return;

        function setButton(theme) {
          btn.textContent = (theme === "dark") ? "‚òÄÔ∏è" : "üåô";
        }

        const saved = localStorage.getItem("theme");
        const systemPrefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
        const initial = saved || (systemPrefersDark ? "dark" : "light");

        root.setAttribute("data-theme", initial);
        setButton(initial);

        btn.addEventListener("click", function () {
          const current = root.getAttribute("data-theme") || "light";
          const next = current === "dark" ? "light" : "dark";
          localStorage.setItem("theme", next);
          root.setAttribute("data-theme", next);
          setButton(next);
        });
      })();
    </script>

    <!-- Mobile menu open/close -->
    <script>
      (function () {
        const btn = document.getElementById("mobileMenuBtn");
        const menu = document.getElementById("mobileMenu");
        const back = document.getElementById("mobileMenuBackdrop");
        const close = document.getElementById("closeMobileMenu");

        if (!btn || !menu || !back || !close) return;

        function open() {
          menu.classList.add("open");
          back.classList.add("open");
          document.body.style.overflow = "hidden";
        }

        function shut() {
          menu.classList.remove("open");
          back.classList.remove("open");
          document.body.style.overflow = "";
        }

        btn.addEventListener("click", open);
        close.addEventListener("click", shut);
        back.addEventListener("click", shut);
        document.addEventListener("keydown", (e) => { if (e.key === "Escape") shut(); });
      })();
    </script>
    <script>
  (function () {
    const openBtn = document.getElementById("openFilters");
    const drawer = document.getElementById("filterDrawer");
    const back = document.getElementById("drawerBackdrop");
    const closeBtn = document.getElementById("closeFilters");

    // Only run on pages that actually have the filters drawer
    if (!openBtn || !drawer || !back || !closeBtn) return;

    function open() {
      drawer.classList.add("open");
      back.classList.add("open");
      drawer.setAttribute("aria-hidden", "false");
      document.body.classList.add("drawer-lock");
    }

    function shut() {
      drawer.classList.remove("open");
      back.classList.remove("open");
      drawer.setAttribute("aria-hidden", "true");
      document.body.classList.remove("drawer-lock");
    }

    openBtn.addEventListener("click", open);
    closeBtn.addEventListener("click", shut);
    back.addEventListener("click", shut);
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") shut(); });
  })();
</script>

  </body>
</html>
