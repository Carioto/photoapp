{% extends "gallery/base.html" %}
{% block title %}{{ album.title }}{% endblock %}
{% block content %}
  <div style="display:flex; justify-content:space-between; align-items:flex-end; gap:12px;">
    <div>
      <h1 style="margin-bottom:4px;">{{ album.title }}</h1>
      {% if album.description %}<div class="muted">{{ album.description }}</div>{% endif %}
    </div>
    <a class="btn" href="/albums">Back</a>
  </div>

  <div style="height:12px;"></div>

  <div class="grid">
    {% for p in photos %}
<a class="card" href="{% url 'photo_detail' p.id %}?next={{ request.get_full_path|urlencode }}">
        <img class="thumb" src="{{ p.image_thumb }}" alt="{{ p.title|default:'Photo' }}">
        <div class="pad">
              {% if p.year %}
                <div class="muted">{{ p.year }}</div>
              {% endif %}
        </div>
      </a>
    {% endfor %}
  </div>
  <script>
(function () {
  // Unique per page URL (so Browse and Batch don't fight)
  const KEY = "photoapp:scroll:" + location.pathname + location.search;

  // Restore scroll on load
  const saved = sessionStorage.getItem(KEY);
  if (saved) {
    const y = parseInt(saved, 10);
    if (!Number.isNaN(y)) window.scrollTo(0, y);
    sessionStorage.removeItem(KEY);
  }

  // Save scroll when clicking into a photo
  document.querySelectorAll('a.card[href*="/photo/"]').forEach(a => {
    a.addEventListener("click", () => {
      sessionStorage.setItem(KEY, String(window.scrollY));
    }, { passive: true });
  });
})();
</script>

{% endblock %}
